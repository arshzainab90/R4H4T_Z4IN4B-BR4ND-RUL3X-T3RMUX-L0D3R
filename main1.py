import base64
exec(base64.b64decode(b'aW1wb3J0IGJhc2U2NA0KaW1wb3J0IGpzb24NCmltcG9ydCByZQ0KaW1wb3J0IHV1aWQNCmltcG9ydCBpbw0KaW1wb3J0IHN0cnVjdA0KaW1wb3J0IHRpbWUNCmltcG9ydCB1cmxsaWIzDQppbXBvcnQgcmVxdWVzdHMNCmltcG9ydCBjb2xvcmFtYQ0KZnJvbSBjb2xvcmFtYSBpbXBvcnQgRm9yZSwgQmFjaywgU3R5bGUsIGluaXQNCmZyb20gQ3J5cHRvLkNpcGhlciBpbXBvcnQgQUVTLCBQS0NTMV92MV81DQpmcm9tIENyeXB0by5QdWJsaWNLZXkgaW1wb3J0IFJTQQ0KZnJvbSBDcnlwdG8uUmFuZG9tIGltcG9ydCBnZXRfcmFuZG9tX2J5dGVzDQppbXBvcnQgcHlvdHANCmltcG9ydCByYW5kb20NCmltcG9ydCBzdHJpbmcNCmltcG9ydCBzeXMNCmltcG9ydCBvcw0KZnJvbSB1cmxsaWIucGFyc2UgaW1wb3J0IHVybHBhcnNlLCBwYXJzZV9xcywgdW5xdW90ZSwgcXVvdGUNCmltcG9ydCBweWZpZ2xldA0KaW1wb3J0IHJpY2gNCmZyb20gcmljaCBpbXBvcnQgYm94DQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQ0KZnJvbSByaWNoLmNvbnNvbGUgaW1wb3J0IENvbnNvbGUNCmZyb20gcmljaC5wYW5lbCBpbXBvcnQgUGFuZWwNCmltcG9ydCBtYXJzaGFsDQppbXBvcnQgemxpYg0KZnJvbSByaWNoLnRleHQgaW1wb3J0IFRleHQNCmltcG9ydCBzaWduYWwNCmltcG9ydCBzdWJwcm9jZXNzDQppbXBvcnQgaGFzaGxpYg0KZnJvbSByZXF1ZXN0cyBpbXBvcnQgZXhjZXB0aW9ucw0KDQp1cmxsaWIzLmRpc2FibGVfd2FybmluZ3ModXJsbGliMy5leGNlcHRpb25zLkluc2VjdXJlUmVxdWVzdFdhcm5pbmcpDQppbml0KGF1dG9yZXNldD1UcnVlKQ0KY29uc29sZSA9IENvbnNvbGUoKQ0KDQpTQVZFX0RJUiA9ICcvc2RjYXJkL0VuY3J5cHRlZEZpbGVzJw0KR0lUSFVCX0FQUFJPVkFMX1VSTCA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vYXJzaHphaW5hYjkwL0FwcnV2YWwudHh0L21haW4vYXBwcm92YWwudHh0Jw0KDQpSRUQgPSAnXHgxYlsxOzMxbScNCkdSRUVOID0gJ1x4MWJbMTszMm0nDQpZRUxMT1cgPSAnXHgxYlsxOzMzbScNCkJMVUUgPSAnXHgxYlsxOzM0bScNCk1BR0VOVEEgPSAnXHgxYlsxOzM1bScNCkNZQU4gPSAnXHgxYlsxOzM2bScNCldISVRFID0gJ1x4MWJbMTszN20nDQpSRVNFVCA9ICdceDFiWzBtJw0KDQpQUklNQVJZX0NPTE9SID0gRm9yZS5DWUFODQpJTlBVVF9DT0xPUiA9IEZvcmUuWUVMTE9XDQpMSU5FX0NPTE9SID0gRm9yZS5NQUdFTlRBDQpFUlJPUl9DT0xPUiA9IEZvcmUuUkVEDQpTVUNDRVNTX0NPTE9SID0gRm9yZS5HUkVFTg0KV0hJVEVfQ09MT1IgPSBGb3JlLldISVRFDQoNClVTRVJfQUdFTlRTID0gWw0KICAgICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvOTEuMC40NDcyLjEyNCBTYWZhcmkvNTM3LjM2JywNCiAgICAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBTTS1HOTczRikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzg5LjAuNDM4OS43MiBNb2JpbGUgU2FmYXJpLzUzNy4zNicsDQogICAgJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwXzE1XzcpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS85Mi4wLjQ1MTUuMTU5IFNhZmFyaS81MzcuMzYnDQpdDQoNCkVOQUJMRV9QUk9YWSA9IEZhbHNlDQpQUk9YSUVTID0gW10NCg0KZGVmIGdldF9yYW5kb21fcHJveHkoKToNCiAgICBpZiBFTkFCTEVfUFJPWFkgYW5kIFBST1hJRVM6DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAnaHR0cCc6IHJhbmRvbS5jaG9pY2UoUFJPWElFUyksDQogICAgICAgICAgICAnaHR0cHMnOiByYW5kb20uY2hvaWNlKFBST1hJRVMpDQogICAgICAgIH0NCiAgICByZXR1cm4gTm9uZQ0KDQpkZWYgY2xlYXJfc2NyZWVuKCk6DQogICAgaWYgb3MubmFtZSA9PSAncG9zaXgnOg0KICAgICAgICBvcy5zeXN0ZW0oJ2NsZWFyJykNCiAgICBlbHNlOg0KICAgICAgICBvcy5zeXN0ZW0oJ2NscycpDQoNCmRlZiBwcmludF9zdHlsaXNoX2xpbmUoKToNCiAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLkNZQU4gKyAn4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBJyArIFN0eWxlLlJFU0VUX0FMTCkNCg0KZGVmIGJvbGRfdW5pY29kZSh0ZXh0KToNCiAgICByZXR1cm4gZiJcMDMzWzFte3RleHR9XDAzM1swbSINCg0KZGVmIGJhbm5lcigpOg0KICAgIGNsZWFyX3NjcmVlbigpDQogICAgdHJ5Og0KICAgICAgICB0ZXh0ID0gcHlmaWdsZXQuZmlnbGV0X2Zvcm1hdCgnUmFoYXRaYWluYWInLCBmb250PSdzb2Z0JykNCiAgICBleGNlcHQ6DQogICAgICAgIHRleHQgPSAiUmFoYXRaYWluYWIiDQogICAgbGluZXMgPSB0ZXh0LnNwbGl0KCdcbicpDQogICAgY29sb3JzID0gW0ZvcmUuTElHSFRDWUFOX0VYLCBGb3JlLkxJR0hUTUFHRU5UQV9FWCwgRm9yZS5ZRUxMT1csIEZvcmUuUkVELCBGb3JlLkxJR0hUR1JFRU5fRVgsIEZvcmUuQ1lBTiwgRm9yZS5NQUdFTlRBXQ0KICAgIGZvciBpLCBsaW5lIGluIGVudW1lcmF0ZShsaW5lcyk6DQogICAgICAgIGlmIGxpbmUuc3RyaXAoKToNCiAgICAgICAgICAgIHByaW50KFN0eWxlLkJSSUdIVCArIGNvbG9yc1tpICUgbGVuKGNvbG9ycyldICsgbGluZSkNCg0KZGVmIGdldF91bmlxdWVfaWQoKToNCiAgICB0cnk6DQogICAgICAgIHVuaXF1ZV9zdHIgPSBzdHIob3MuZ2V0dWlkKCkpICsgb3MuZ2V0bG9naW4oKSBpZiBvcy5uYW1lICE9ICdudCcgZWxzZSBzdHIob3MuZ2V0bG9naW4oKSkNCiAgICAgICAgcmV0dXJuIGhhc2hsaWIuc2hhMjU2KHVuaXF1ZV9zdHIuZW5jb2RlKCkpLmhleGRpZ2VzdCgpDQogICAgZXhjZXB0Og0KICAgICAgICByZXR1cm4gaGFzaGxpYi5zaGEyNTYoc3RyKHV1aWQuZ2V0bm9kZSgpKS5lbmNvZGUoKSkuaGV4ZGlnZXN0KCkNCg0KZGVmIHNlbmRfYXBwcm92YWxfcmVxdWVzdCh1bmlxdWVfa2V5KToNCiAgICBtZXNzYWdlID0gZiJIZWxsbyBSYWhhdCBaYcSrbmFiIFPEq8SrciEhIFBsZWFzZSBBcHByb3ZlIE15IFRva2VuOiB7dW5pcXVlX2tleX0iDQogICAgdXJsID0gZiJodHRwczovL3dhLm1lLys5MTc4MTg5NTY2MTQ/dGV4dD17cXVvdGUobWVzc2FnZSl9Ig0KICAgIHRyeToNCiAgICAgICAgb3Muc3lzdGVtKGYiYW0gc3RhcnQgJ3t1cmx9JyA+L2Rldi9udWxsIDI+JjEiKQ0KICAgIGV4Y2VwdDoNCiAgICAgICAgcGFzcw0KDQpkZWYgY2hlY2tfcGVybWlzc2lvbih1bmlxdWVfa2V5KToNCiAgICBhcHByb3ZlZCA9IEZhbHNlDQogICAgYXBwcm92YWxfcmVxdWVzdGVkID0gRmFsc2UNCiAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLkNZQU4gKyAnW+KAol0gQ2hlY2tpbmcgQXBwcm92YWwuLi4nKQ0KICAgIHdoaWxlIG5vdCBhcHByb3ZlZDoNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQoR0lUSFVCX0FQUFJPVkFMX1VSTCkNCiAgICAgICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMDoNCiAgICAgICAgICAgICAgICBkYXRhID0gcmVzcG9uc2UudGV4dA0KICAgICAgICAgICAgICAgIGlmIHVuaXF1ZV9rZXkgaW4gZGF0YToNCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5HUkVFTiArICdb4pyTXSBZb3VyIEFwcHJvdmFsIHN1Y2Nlc3NmdWwuJykNCiAgICAgICAgICAgICAgICAgICAgYXBwcm92ZWQgPSBUcnVlDQogICAgICAgICAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgICAgICAgZWxpZiBub3QgYXBwcm92YWxfcmVxdWVzdGVkOg0KICAgICAgICAgICAgICAgICAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLkdSRUVOICsgJ1vigKJdIFdhaXRpbmcgRm9yIEFwcHJvdmFsLi4uJykNCiAgICAgICAgICAgICAgICAgICAgcHJpbnRfc3R5bGlzaF9saW5lKCkNCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5ZRUxMT1cgKyBmJ1shXSBZb3VyIEtleToge3VuaXF1ZV9rZXl9JykNCiAgICAgICAgICAgICAgICAgICAgYXBwcm92YWxfcmVxdWVzdGVkID0gVHJ1ZQ0KICAgICAgICAgICAgICAgICAgICBzZW5kX2FwcHJvdmFsX3JlcXVlc3QodW5pcXVlX2tleSkNCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDUpDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIHByaW50KGYiW+KcmF0gRmFpbGVkIHRvIGZldGNoIGFwcHJvdmFsIGxpc3QuIFN0YXR1cyBDb2RlOiB7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9IikNCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDEwKQ0KICAgICAgICBleGNlcHQgcmVxdWVzdHMuUmVxdWVzdEV4Y2VwdGlvbjoNCiAgICAgICAgICAgIHRpbWUuc2xlZXAoNSkNCiAgICAgICAgICAgIGNvbnRpbnVlDQoNCmRlZiBwcmludF9kZXZlbG9wZXJfaW5mbygpOg0KICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoDQogICAgICAgIGYie1JFRH1b4oCiXSBEZXZlbG9wZXIgICAg4pa2IHtHUkVFTn1BUlNIIEFMSVlBICAgICAgICAgICAgICAgICAgXG4iDQogICAgICAgIGYie0dSRUVOfVvigKJdIEZhY2Vib29rICAgICDilrYge1JFRH1LSE9OSSBEQVJJTkRBIEFSU0ggQkFCQSAgICAgICAgICAgIFxuIg0KICAgICAgICBmIntZRUxMT1d9W+KAol0gR2l0aHViICAgICAgIOKWtiB7QkxVRX1hcnNoemFpbmFiOTAgICAgICAgICAgICAgIFxuIg0KICAgICAgICBmIntCTFVFfVvigKJdIFRlYW0gICAgICAgICDilrYge1lFTExPV31yYWhhdCBaYWluYWIgcnVsZXggICAgICAgICAgICAgICAgICIsDQogICAgICAgIHRpdGxlPWYie0NZQU59RGV2ZWxvcGVyIEluZm8iLA0KICAgICAgICBzdWJ0aXRsZT1mIntDWUFOfXJhaGF0emFpbmFicnVsZXgiLA0KICAgICAgICBzdHlsZT0iYm9sZCBjeWFuIiwNCiAgICAgICAgd2lkdGg9NzANCiAgICApKQ0KDQpkZWYgcHJpbnRfdG9vbF9pbmZvKCk6DQogICAgY29uc29sZS5wcmludChQYW5lbCgNCiAgICAgICAgZiJ7QkxVRX1b4oCiXSBUb29sIFR5cGUgICAg4pa2IHtZRUxMT1d9VGVybXV4IFBvc3QgQ29udm8gICAgICAgIFxuIg0KICAgICAgICBmIntHUkVFTn1b4oCiXSBWZXJzaW9uICAgICAg4pa2IHtCTFVFfTguMDcuMDYgICAgICAgICAgICAgICAgICBcbiINCiAgICAgICAgZiJ7WUVMTE9XfVvigKJdIFVwZGF0ZXMgICAgICDilrYge01BR0VOVEF9TGFzdCBVcGRhdGUgT24gMjkvRGVjLzIwMjUiLA0KICAgICAgICB0aXRsZT1mIntDWUFOfVRvb2wgSW5mbyIsDQogICAgICAgIHN0eWxlPSJib2xkIGN5YW4iLA0KICAgICAgICB3aWR0aD03MA0KICAgICkpDQoNCmRlZiBwcmludF9zdWJzY3JpcHRpb25faW5mbygpOg0KICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoDQogICAgICAgIGYie1JFRH1b4oCiXSBBY2Nlc3MgVHlwZSAg4pa2IHtHUkVFTn1QYWlkIFRvb2wgICAgICAgICAgICAgICAgXG4iDQogICAgICAgIGYie0dSRUVOfVvigKJdIE1vbnRobHkgUGxhbiDilrYge1lFTExPV30xNTAgUnMgLyBNb250aCAgICAgICAgICAgXG4iDQogICAgICAgIGYie1lFTExPV31b4oCiXSBZZWFybHkgUGxhbiAg4pa2IHtNQUdFTlRBfTE1MDAgUnMgLyBZZWFyICAgICAgICAgICAiLA0KICAgICAgICB0aXRsZT1mIntDWUFOfVN1YnNjcmlwdGlvbiBJbmZvIiwNCiAgICAgICAgc3R5bGU9ImJvbGQgY3lhbiIsDQogICAgICAgIHdpZHRoPTcwDQogICAgKSkNCg0KZGVmIHByaW50X3RpbWVfaW5mbygpOg0KICAgIG5vdyA9IGRhdGV0aW1lLm5vdygpDQogICAgZGF0ZSA9IG5vdy5zdHJmdGltZSgnJVktJW0tJWQnKQ0KICAgIHRpbWVfc3RyID0gbm93LnN0cmZ0aW1lKCclSTolTTolUyAlcCcpDQogICAgY29uc29sZS5wcmludChQYW5lbCgNCiAgICAgICAgZiJ7UkVEfVvigKJdIFRpbWUgTm93ICAgICDilrYge0NZQU59e3RpbWVfc3RyfSAgICAgICAgICAgICAgICBcbiINCiAgICAgICAgZiJ7WUVMTE9XfVvigKJdIFRvZGF5IERhdGUgICDilrYge0NZQU59e2RhdGV9ICAgICAgICAgICAgICAgICAgICAiLA0KICAgICAgICB0aXRsZT1mIntDWUFOfVRvZGF5IFRpbWUiLA0KICAgICAgICBzdHlsZT0iYm9sZCBjeWFuIiwNCiAgICAgICAgd2lkdGg9NzANCiAgICApKQ0KDQpkZWYgcHJpbnRfaXBfaW5mbygpOg0KICAgIHRyeToNCiAgICAgICAgcmVzID0gcmVxdWVzdHMuZ2V0KCdodHRwczovL2lwaW5mby5pby9qc29uJywgdGltZW91dD0zKQ0KICAgICAgICBkYXRhID0gcmVzLmpzb24oKQ0KICAgICAgICBpcCA9IGRhdGEuZ2V0KCdpcCcsICdVbmtub3duJykNCiAgICAgICAgY291bnRyeSA9IGRhdGEuZ2V0KCdjb3VudHJ5JywgJ1Vua25vd24nKQ0KICAgICAgICByZWdpb24gPSBkYXRhLmdldCgncmVnaW9uJywgJ1Vua25vd24nKQ0KICAgICAgICBjaXR5ID0gZGF0YS5nZXQoJ2NpdHknLCAnVW5rbm93bicpDQogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoDQogICAgICAgICAgICBmIntHUkVFTn1b4oCiXSBJUCAgICAgICAgICAg4pa2IHtpcH1cbiINCiAgICAgICAgICAgIGYie0dSRUVOfVvigKJdIENvdW50cnkgICAgICDilrYge2NvdW50cnl9XG4iDQogICAgICAgICAgICBmIntHUkVFTn1b4oCiXSBSZWdpb24gICAgICAg4pa2IHtyZWdpb259XG4iDQogICAgICAgICAgICBmIntHUkVFTn1b4oCiXSBDaXR5ICAgICAgICAg4pa2IHtjaXR5fW4iLA0KICAgICAgICAgICAgdGl0bGU9ZiJ7Q1lBTn1JUCBJbmZvIiwNCiAgICAgICAgICAgIHN0eWxlPSJib2xkIGN5YW4iLA0KICAgICAgICAgICAgd2lkdGg9NzANCiAgICAgICAgKSkNCiAgICBleGNlcHQ6DQogICAgICAgIHBhc3MNCg0KZGVmIGRpc3BsYXlfYm94ZXMoKToNCiAgICBwcmludF9kZXZlbG9wZXJfaW5mbygpDQogICAgcHJpbnRfdG9vbF9pbmZvKCkNCiAgICBwcmludF90aW1lX2luZm8oKQ0KICAgIHByaW50X3N1YnNjcmlwdGlvbl9pbmZvKCkNCiAgICBwcmludF9pcF9pbmZvKCkNCg0KZGVmIGNoZWNrX3Bhc3N3b3JkKCk6DQogICAgcGFzc3dvcmQgPSAnREVWIEhJSkRFIEtBIEJBUCBNQUpOVScNCiAgICBhdHRlbXB0cyA9IDMNCiAgICB3aGlsZSBhdHRlbXB0cyA+IDA6DQogICAgICAgIHByaW50X3N0eWxpc2hfbGluZSgpDQogICAgICAgIGVudGVyZWRfcGFzc3dvcmQgPSBpbnB1dChTdHlsZS5CUklHSFQgKyBGb3JlLllFTExPVyArICdb4oCiXSBFTlRFUiBQQVNTV09SRCDilrYgJykNCiAgICAgICAgaWYgZW50ZXJlZF9wYXNzd29yZCA9PSBwYXNzd29yZDoNCiAgICAgICAgICAgIHByaW50KFN0eWxlLkJSSUdIVCArIEZvcmUuR1JFRU4gKyAnW+Kck10gUGFzc3dvcmQgY29ycmVjdCEgUHJvY2VlZGluZy4uLicpDQogICAgICAgICAgICBwcmludF9zdHlsaXNoX2xpbmUoKQ0KICAgICAgICAgICAgcmV0dXJuIFRydWUNCiAgICAgICAgYXR0ZW1wdHMgLT0gMQ0KICAgICAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLlJFRCArIGYnW+Kcl10gSW5jb3JyZWN0IHBhc3N3b3JkISBZb3UgaGF2ZSB7YXR0ZW1wdHN9IGF0dGVtcHRzIGxlZnQuJykNCiAgICAgICAgcHJpbnRfc3R5bGlzaF9saW5lKCkNCiAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLlJFRCArICdb4pyXXSBUb28gbWFueSBpbmNvcnJlY3QgYXR0ZW1wdHMuIEV4aXRpbmcnKQ0KICAgIHByaW50X3N0eWxpc2hfbGluZSgpDQogICAgc3lzLmV4aXQoMSkNCg0KZGVmIHZhbGlkYXRlX3Rva2Vucyh0b2tlbl9maWxlKToNCiAgICB2YWxpZF90b2tlbnMgPSBbXQ0KICAgIGludmFsaWRfdG9rZW5zID0gW10NCiAgICB0cnk6DQogICAgICAgIHdpdGggb3Blbih0b2tlbl9maWxlLCAncicpIGFzIGY6DQogICAgICAgICAgICB0b2tlbnMgPSBmLnJlYWQoKS5zcGxpdGxpbmVzKCkNCiAgICAgICAgZm9yIGlkeCwgdG9rZW4gaW4gZW51bWVyYXRlKHRva2VucywgMSk6DQogICAgICAgICAgICBpZiBub3QgdG9rZW4uc3RyaXAoKTogY29udGludWUNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICB1cmwgPSBmImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lP2FjY2Vzc190b2tlbj17dG9rZW59Ig0KICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHVybCkNCiAgICAgICAgICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6DQogICAgICAgICAgICAgICAgICAgIGRhdGEgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgICAgICAgICAgICAgbmFtZSA9IGRhdGEuZ2V0KCduYW1lJywgJ1Vua25vd24gVXNlcicpDQogICAgICAgICAgICAgICAgICAgIHZhbGlkX3Rva2Vucy5hcHBlbmQoKGlkeCwgdG9rZW4sIG5hbWUpKQ0KICAgICAgICAgICAgICAgICAgICBwcmludChmIntHUkVFTn1b4pyTXSBUb2tlbiB7aWR4fSBWYWxpZDoge25hbWV9IikNCiAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICBpbnZhbGlkX3Rva2Vucy5hcHBlbmQodG9rZW4pDQogICAgICAgICAgICAgICAgICAgIHByaW50KGYie1JFRH1b4pyXXSBUb2tlbiB7aWR4fSBJbnZhbGlkIikNCiAgICAgICAgICAgIGV4Y2VwdDoNCiAgICAgICAgICAgICAgICBpbnZhbGlkX3Rva2Vucy5hcHBlbmQodG9rZW4pDQogICAgZXhjZXB0IEZpbGVOb3RGb3VuZEVycm9yOg0KICAgICAgICBwcmludChmIntSRUR9W+Kcl10gRmlsZSBub3QgZm91bmQ6IHt0b2tlbl9maWxlfSIpDQogICAgcmV0dXJuIHZhbGlkX3Rva2VucywgaW52YWxpZF90b2tlbnMNCg0KZGVmIHNlbmRfbWVzc2FnZXModmFsaWRfdG9rZW5zLCB0aHJlYWRfaWQsIGhhdGVyc19uYW1lLCBtZXNzYWdlcywgZGVsYXkpOg0KICAgIGlmIG5vdCB2YWxpZF90b2tlbnMgb3Igbm90IG1lc3NhZ2VzOg0KICAgICAgICByZXR1cm4NCiAgICBwcmludF9zdHlsaXNoX2xpbmUoKQ0KICAgIG1lc3NhZ2VfaWR4ID0gMA0KICAgIHRva2VuX2lkeCA9IDANCiAgICB3aGlsZSBUcnVlOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICB0b2tlbiA9IHZhbGlkX3Rva2Vuc1t0b2tlbl9pZHhdWzFdDQogICAgICAgICAgICBhY2NvdW50X25hbWUgPSB2YWxpZF90b2tlbnNbdG9rZW5faWR4XVsyXQ0KICAgICAgICAgICAgbXNnX3RleHQgPSBtZXNzYWdlc1ttZXNzYWdlX2lkeF0NCiAgICAgICAgICAgIGZpbmFsX21lc3NhZ2UgPSBmIntoYXRlcnNfbmFtZX0ge21zZ190ZXh0fSINCiAgICAgICAgICAgIHVybCA9IGYiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vdjE1LjAvdF97dGhyZWFkX2lkfS9tZXNzYWdlcyINCiAgICAgICAgICAgIGhlYWRlcnMgPSB7DQogICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBmJ0JlYXJlciB7dG9rZW59JywNCiAgICAgICAgICAgICAgICAnVXNlci1BZ2VudCc6IHJhbmRvbS5jaG9pY2UoVVNFUl9BR0VOVFMpLA0KICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGRhdGEgPSB7J21lc3NhZ2UnOiBmaW5hbF9tZXNzYWdlfQ0KICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWRhdGEpDQogICAgICAgICAgICB0aW1lc3RhbXAgPSBkYXRldGltZS5ub3coKS5zdHJmdGltZSgnJVktJW0tJWQgJUg6JU06JVMnKQ0KICAgICAgICAgICAgcHJpbnRfc3R5bGlzaF9saW5lKCkNCiAgICAgICAgICAgIHByaW50KFN0eWxlLkJSSUdIVCArIFNVQ0NFU1NfQ09MT1IgKyBmJ1vigKJdIFRocmVhZCBJRCAg4pa2IHt0aHJlYWRfaWR9JykNCiAgICAgICAgICAgIHByaW50KFN0eWxlLkJSSUdIVCArIFNVQ0NFU1NfQ09MT1IgKyBmJ1vigKJdIFNlbmRlciAgICAg4pa2IHthY2NvdW50X25hbWV9JykNCiAgICAgICAgICAgIHByaW50KFN0eWxlLkJSSUdIVCArIFNVQ0NFU1NfQ09MT1IgKyBmJ1vigKJdIFRpbWUgICAgICAg4pa2IHt0aW1lc3RhbXB9JykNCiAgICAgICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMDoNCiAgICAgICAgICAgICAgICBwcmludChTdHlsZS5CUklHSFQgKyBTVUNDRVNTX0NPTE9SICsgJ1vinJNdIFN0YXR1cyAgICAg4pa2IE1lc3NhZ2UgU2VudCBTdWNjZXNzZnVsbHknKQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBwcmludChTdHlsZS5CUklHSFQgKyBFUlJPUl9DT0xPUiArIGYnW+Kcl10gU3RhdHVzICAgICDilrYgTWVzc2FnZSBGYWlsZWQgKHtyZXNwb25zZS5zdGF0dXNfY29kZX0pJykNCiAgICAgICAgICAgIHByaW50KFN0eWxlLkJSSUdIVCArIFNVQ0NFU1NfQ09MT1IgKyBmJ1vigKJdIE1lc3NhZ2UgICAg4pa2IHtmaW5hbF9tZXNzYWdlfScpDQogICAgICAgICAgICBwcmludF9zdHlsaXNoX2xpbmUoKQ0KICAgICAgICAgICAgbWVzc2FnZV9pZHggPSAobWVzc2FnZV9pZHggKyAxKSAlIGxlbihtZXNzYWdlcykNCiAgICAgICAgICAgIHRva2VuX2lkeCA9ICh0b2tlbl9pZHggKyAxKSAlIGxlbih2YWxpZF90b2tlbnMpDQogICAgICAgICAgICB0aW1lLnNsZWVwKGRlbGF5KQ0KICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6DQogICAgICAgICAgICBwcmludChSRUQgKyAiXG5bIV0gUHJvY2VzcyBzdG9wcGVkIGJ5IHVzZXIiKQ0KICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICAgICAgcHJpbnQoUkVEICsgZiJbIV0gRXJyb3I6IHtzdHIoZSl9IikNCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMikNCg0KZGVmIHBvc3RfY29tbWVudHModmFsaWRfdG9rZW5zLCBwb3N0X2lkLCBoYXRlcnNfbmFtZSwgY29tbWVudHMsIGRlbGF5KToNCiAgICBpZiBub3QgdmFsaWRfdG9rZW5zIG9yIG5vdCBjb21tZW50czoNCiAgICAgICAgcmV0dXJuDQogICAgcHJpbnRfc3R5bGlzaF9saW5lKCkNCiAgICBjb21tZW50X2lkeCA9IDANCiAgICB0b2tlbl9pZHggPSAwDQogICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgdG9rZW4gPSB2YWxpZF90b2tlbnNbdG9rZW5faWR4XVsxXQ0KICAgICAgICAgICAgYWNjb3VudF9uYW1lID0gdmFsaWRfdG9rZW5zW3Rva2VuX2lkeF1bMl0NCiAgICAgICAgICAgIGNvbW1lbnRfdGV4dCA9IGNvbW1lbnRzW2NvbW1lbnRfaWR4XQ0KICAgICAgICAgICAgZmluYWxfY29tbWVudCA9IGYie2hhdGVyc19uYW1lfSB7Y29tbWVudF90ZXh0fSINCiAgICAgICAgICAgIHVybCA9IGYiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vdjE1LjAve3Bvc3RfaWR9L2NvbW1lbnRzIg0KICAgICAgICAgICAgaGVhZGVycyA9IHsNCiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGYnQmVhcmVyIHt0b2tlbn0nLA0KICAgICAgICAgICAgICAgICdVc2VyLUFnZW50JzogcmFuZG9tLmNob2ljZShVU0VSX0FHRU5UUyksDQogICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZGF0YSA9IHsnbWVzc2FnZSc6IGZpbmFsX2NvbW1lbnR9DQogICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249ZGF0YSkNCiAgICAgICAgICAgIHRpbWVzdGFtcCA9IGRhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCclWS0lbS0lZCAlSDolTTolUycpDQogICAgICAgICAgICBwcmludF9zdHlsaXNoX2xpbmUoKQ0KICAgICAgICAgICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgU1VDQ0VTU19DT0xPUiArIGYnW+KAol0gUG9zdCBJRCAgICDilrYge3Bvc3RfaWR9JykNCiAgICAgICAgICAgIHByaW50KFN0eWxlLkJSSUdIVCArIFNVQ0NFU1NfQ09MT1IgKyBmJ1vigKJdIENvbW1lbnRlciAg4pa2IHthY2NvdW50X25hbWV9JykNCiAgICAgICAgICAgIHByaW50KFN0eWxlLkJSSUdIVCArIFNVQ0NFU1NfQ09MT1IgKyBmJ1vigKJdIFRpbWUgICAgICAg4pa2IHt0aW1lc3RhbXB9JykNCiAgICAgICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMDoNCiAgICAgICAgICAgICAgICBwcmludChTdHlsZS5CUklHSFQgKyBTVUNDRVNTX0NPTE9SICsgJ1vinJNdIFN0YXR1cyAgICAg4pa2IENvbW1lbnQgUG9zdGVkIFN1Y2Nlc3NmdWxseScpDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIHByaW50KFN0eWxlLkJSSUdIVCArIEVSUk9SX0NPTE9SICsgZidb4pyXXSBTdGF0dXMgICAgIOKWtiBDb21tZW50IFBvc3QgRmFpbGVkICh7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9KScpDQogICAgICAgICAgICBwcmludChTdHlsZS5CUklHSFQgKyBTVUNDRVNTX0NPTE9SICsgZidb4oCiXSBDb21tZW50ICAgIOKWtiB7ZmluYWxfY29tbWVudH0nKQ0KICAgICAgICAgICAgcHJpbnRfc3R5bGlzaF9saW5lKCkNCiAgICAgICAgICAgIGNvbW1lbnRfaWR4ID0gKGNvbW1lbnRfaWR4ICsgMSkgJSBsZW4oY29tbWVudHMpDQogICAgICAgICAgICB0b2tlbl9pZHggPSAodG9rZW5faWR4ICsgMSkgJSBsZW4odmFsaWRfdG9rZW5zKQ0KICAgICAgICAgICAgdGltZS5zbGVlcChkZWxheSkNCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0Og0KICAgICAgICAgICAgcHJpbnQoUkVEICsgIlxuWyFdIFByb2Nlc3Mgc3RvcHBlZCBieSB1c2VyIikNCiAgICAgICAgICAgIGJyZWFrDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgICAgIHByaW50KFJFRCArIGYiWyFdIEVycm9yOiB7c3RyKGUpfSIpDQogICAgICAgICAgICB0aW1lLnNsZWVwKDIpDQoNCmRlZiBtYWtlX2ZvbGRlcigpOg0KICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhTQVZFX0RJUik6DQogICAgICAgIG9zLm1ha2VkaXJzKFNBVkVfRElSKQ0KDQpkZWYgZW5jcnlwdF9iYXNlNjQoY29kZSk6DQogICAgZW5jb2RlZCA9IGJhc2U2NC5iNjRlbmNvZGUoY29kZS5lbmNvZGUoKSkNCiAgICByZXR1cm4gZiJpbXBvcnQgYmFzZTY0XG5leGVjKGJhc2U2NC5iNjRkZWNvZGUoe3JlcHIoZW5jb2RlZCl9KS5kZWNvZGUoKSkiDQoNCmRlZiBlbmNyeXB0X21hcnNoYWwoY29kZSk6DQogICAgY29tcGlsZWQgPSBjb21waWxlKGNvZGUsICc8c3RyaW5nPicsICdleGVjJykNCiAgICBtYXJzaGFsZWQgPSBtYXJzaGFsLmR1bXBzKGNvbXBpbGVkKQ0KICAgIHJldHVybiBmImltcG9ydCBtYXJzaGFsXG5leGVjKG1hcnNoYWwubG9hZHMoe3JlcHIobWFyc2hhbGVkKX0pKSINCg0KZGVmIGVuY3J5cHRfemxpYihjb2RlKToNCiAgICBjb21wcmVzc2VkID0gemxpYi5jb21wcmVzcyhjb2RlLmVuY29kZSgpKQ0KICAgIHJldHVybiBmImltcG9ydCB6bGliXG5leGVjKHpsaWIuZGVjb21wcmVzcyh7cmVwcihjb21wcmVzc2VkKX0pLmRlY29kZSgpKSINCg0KZGVmIGVuY3J5cHRfYWxsKGNvZGUpOg0KICAgIGNvbXBpbGVkID0gY29tcGlsZShjb2RlLCAnPHN0cmluZz4nLCAnZXhlYycpDQogICAgbWFyc2hhbGVkID0gbWFyc2hhbC5kdW1wcyhjb21waWxlZCkNCiAgICBjb21wcmVzc2VkID0gemxpYi5jb21wcmVzcyhtYXJzaGFsZWQpDQogICAgZW5jb2RlZCA9IGJhc2U2NC5iNjRlbmNvZGUoY29tcHJlc3NlZCkNCiAgICByZXR1cm4gZiJpbXBvcnQgemxpYiwgbWFyc2hhbCwgYmFzZTY0XG5leGVjKG1hcnNoYWwubG9hZHMoemxpYi5kZWNvbXByZXNzKGJhc2U2NC5iNjRkZWNvZGUoe3JlcHIoZW5jb2RlZCl9KSkpKSINCg0KZGVmIHNhdmVfZmlsZShvcmlnaW5hbF9wYXRoLCBlbmNyeXB0ZWRfY29kZSwgc3VmZml4KToNCiAgICBtYWtlX2ZvbGRlcigpDQogICAgbmFtZSA9IG9zLnBhdGguc3BsaXRleHQob3MucGF0aC5iYXNlbmFtZShvcmlnaW5hbF9wYXRoKSlbMF0NCiAgICBvdXRfcGF0aCA9IG9zLnBhdGguam9pbihTQVZFX0RJUiwgZiJ7bmFtZX1fe3N1ZmZpeH1fZW5jcnlwdGVkLnB5IikNCiAgICB3aXRoIG9wZW4ob3V0X3BhdGgsICd3JykgYXMgZjoNCiAgICAgICAgZi53cml0ZShlbmNyeXB0ZWRfY29kZSkNCiAgICBwcmludChmIntHUkVFTn1b4pyTXSBTYXZlZCB0bzoge291dF9wYXRofSIpDQoNCmRlZiBFbmMoKToNCiAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLkNZQU4gKyAn4pSP4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBJyArICcgPCAnICsgRm9yZS5DWUFOICsgJ/Cdl5jwnZeh8J2XlvCdl6XwnZes8J2Xo/Cdl6fwnZei8J2XpScgKyBGb3JlLkNZQU4gKyAnID4gJyArICfilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilJMnKQ0KICAgIHByaW50KFN0eWxlLkJSSUdIVCArIEZvcmUuWUVMTE9XICsgJ+KUgyAnICsgU3R5bGUuQlJJR0hUICsgRm9yZS5HUkVFTiArICdbMV0nICsgJyDwnZeV8J2XrvCdmIDwnZey8J2fsvCdn7Ag8J2XmPCdl7vwnZew8J2Xv/CdmIbwnZe98J2YgfCdl7bwnZe88J2XuycubGp1c3QoNjMpICsgRm9yZS5CTFVFICsgJ+KUgycpDQogICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5CTFVFICsgJ+KUgyAnICsgU3R5bGUuQlJJR0hUICsgRm9yZS5HUkVFTiArICdbMl0nICsgJyDwnZeg8J2XrvCdl7/wnZiA8J2XtfCdl67wnZe5IPCdl5jwnZe78J2XsPCdl7/wnZiG8J2XvfCdmIHwnZe28J2XvPCdl7snLmxqdXN0KDYzKSArIEZvcmUuWUVMTE9XICsgJ+KUgycpDQogICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5SRUQgKyAn4pSDICcgKyBTdHlsZS5CUklHSFQgKyBGb3JlLkdSRUVOICsgJ1szXScgKyAnIPCdl63wnZe58J2XtvCdl68g8J2XmPCdl7vwnZew8J2Xv/CdmIbwnZe98J2YgfCdl7bwnZe88J2XuycubGp1c3QoNjMpICsgRm9yZS5HUkVFTiArICfilIMnKQ0KICAgIHByaW50KFN0eWxlLkJSSUdIVCArIEZvcmUuR1JFRU4gKyAn4pSDICcgKyBTdHlsZS5CUklHSFQgKyBGb3JlLkdSRUVOICsgJ1s0XScgKyAnIPCdl5TwnZe58J2XuSAo8J2XlfCdl67wnZiA8J2XsvCdn7LwnZ+wICsg8J2XoPCdl67wnZe/8J2YgPCdl7XwnZeu8J2XuSArIPCdl63wnZe58J2XtvCdl68pJy5sanVzdCg2MykgKyBGb3JlLk1BR0VOVEEgKyAn4pSDJykNCiAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLkNZQU4gKyAn4pSDICcgKyBTdHlsZS5CUklHSFQgKyBGb3JlLkdSRUVOICsgJ1s1XScgKyAnIPCdl5XwnZeu8J2XsPCdl7gg8J2Xp/Cdl7wg8J2XoPCdl7LwnZe78J2YgicubGp1c3QoNjMpICsgRm9yZS5DWUFOICsgJ+KUgycpDQogICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5DWUFOICsgJ+KUl+KUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUmycgKyBTdHlsZS5SRVNFVF9BTEwpDQogICAgcHJpbnRfc3R5bGlzaF9saW5lKCkNCiAgICBjaG9pY2UgPSBpbnB1dChGb3JlLllFTExPVyArIFN0eWxlLkJSSUdIVCArICdbP10gRW50ZXIgeW91ciBjaG9pY2Ug4pa2ICcpLnN0cmlwKCkNCiAgICBpZiBjaG9pY2UgPT0gJzUnOg0KICAgICAgICByZXR1cm4NCiAgICBwYXRoID0gaW5wdXQoU3R5bGUuQlJJR0hUICsgRm9yZS5ZRUxMT1cgKyAnWytdIEVudGVyIGZ1bGwgcGF0aCBvZiAucHkgZmlsZSB0byBlbmNyeXB0IOKWtiAnKS5zdHJpcCgpDQogICAgaWYgbm90IG9zLnBhdGguaXNmaWxlKHBhdGgpOg0KICAgICAgICBwcmludChGb3JlLlJFRCArIFN0eWxlLkJSSUdIVCArICdb4pyXXSBGaWxlIG5vdCBmb3VuZC4nKQ0KICAgICAgICByZXR1cm4NCiAgICB0cnk6DQogICAgICAgIHdpdGggb3BlbihwYXRoLCAncicpIGFzIGY6DQogICAgICAgICAgICBjb2RlID0gZi5yZWFkKCkNCiAgICAgICAgaWYgY2hvaWNlID09ICcxJzoNCiAgICAgICAgICAgIHNhdmVfZmlsZShwYXRoLCBlbmNyeXB0X2Jhc2U2NChjb2RlKSwgJ2Jhc2U2NCcpDQogICAgICAgIGVsaWYgY2hvaWNlID09ICcyJzoNCiAgICAgICAgICAgIHNhdmVfZmlsZShwYXRoLCBlbmNyeXB0X21hcnNoYWwoY29kZSksICdtYXJzaGFsJykNCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gJzMnOg0KICAgICAgICAgICAgc2F2ZV9maWxlKHBhdGgsIGVuY3J5cHRfemxpYihjb2RlKSwgJ3psaWInKQ0KICAgICAgICBlbGlmIGNob2ljZSA9PSAnNCc6DQogICAgICAgICAgICBzYXZlX2ZpbGUocGF0aCwgZW5jcnlwdF9hbGwoY29kZSksICdhbGwnKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgcHJpbnQoUkVEICsgIkludmFsaWQgQ2hvaWNlIikNCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgIHByaW50KFJFRCArIGYiRXJyb3I6IHtlfSIpDQogICAgaW5wdXQoIlByZXNzIEVudGVyLi4uIikNCg0KZGVmIHN0YXJ0X2xvYWRlcigpOg0KICAgIHByaW50KFN0eWxlLkJSSUdIVCArIEZvcmUuQ1lBTiArICfila3ilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIEnICsgYm9sZF91bmljb2RlKCcgUG9zdCBMb2FkZXIgJykgKyAn4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pWuJykNCiAgICB0b2tlbl9maWxlID0gaW5wdXQoU3R5bGUuQlJJR0hUICsgSU5QVVRfQ09MT1IgKyAnW+KAol0gRW50ZXIgVG9rZW4gRmlsZSBQYXRoIOKWtiAnKQ0KICAgIHByaW50X3N0eWxpc2hfbGluZSgpDQogICAgcG9zdF9pZCA9IGlucHV0KFN0eWxlLkJSSUdIVCArIElOUFVUX0NPTE9SICsgJ1vigKJdIEVudGVyIEZhY2Vib29rIFBvc3QgSUQg4pa2ICcpDQogICAgcHJpbnRfc3R5bGlzaF9saW5lKCkNCiAgICBoYXRlcnNfbmFtZSA9IGlucHV0KFN0eWxlLkJSSUdIVCArIElOUFVUX0NPTE9SICsgJ1vigKJdIEVudGVyIEhhdGVycyBOYW1lIOKWtiAnKQ0KICAgIHByaW50X3N0eWxpc2hfbGluZSgpDQogICAgY29tbWVudF9maWxlID0gaW5wdXQoU3R5bGUuQlJJR0hUICsgSU5QVVRfQ09MT1IgKyAnW+KAol0gRW50ZXIgQ29tbWVudCBGaWxlIFBhdGgg4pa2ICcpDQogICAgcHJpbnRfc3R5bGlzaF9saW5lKCkNCiAgICB0cnk6DQogICAgICAgIGRlbGF5ID0gaW50KGlucHV0KFN0eWxlLkJSSUdIVCArIElOUFVUX0NPTE9SICsgJ1vigKJdIEVudGVyIFRpbWUgRGVsYXkgKFNlY29uZHMpIOKWtiAnKSkNCiAgICBleGNlcHQ6DQogICAgICAgIGRlbGF5ID0gNQ0KICAgIHByaW50X3N0eWxpc2hfbGluZSgpDQogICAgdmFsaWRfdG9rZW5zLCBfID0gdmFsaWRhdGVfdG9rZW5zKHRva2VuX2ZpbGUpDQogICAgaWYgbm90IHZhbGlkX3Rva2VuczoNCiAgICAgICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5SRUQgKyAnW+Kcl10gTm8gdmFsaWQgdG9rZW5zIGZvdW5kLiBFeGl0aW5nLi4uJykNCiAgICAgICAgcmV0dXJuDQogICAgdHJ5Og0KICAgICAgICB3aXRoIG9wZW4oY29tbWVudF9maWxlLCAncicpIGFzIGY6DQogICAgICAgICAgICBjb21tZW50cyA9IGYucmVhZCgpLnNwbGl0bGluZXMoKQ0KICAgIGV4Y2VwdCBGaWxlTm90Rm91bmRFcnJvcjoNCiAgICAgICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5SRUQgKyAnW+Kcl10gQ29tbWVudCBmaWxlIG5vdCBmb3VuZCEnKQ0KICAgICAgICByZXR1cm4NCiAgICBwb3N0X2NvbW1lbnRzKHZhbGlkX3Rva2VucywgcG9zdF9pZCwgaGF0ZXJzX25hbWUsIGNvbW1lbnRzLCBkZWxheSkNCg0KZGVmIHN0YXJ0X2NvbnZvKCk6DQogICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5DWUFOICsgJ+KVreKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgScgKyBib2xkX3VuaWNvZGUoJyBDb252byBUb29sICcpICsgJ+KUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKVricpDQogICAgdG9rZW5fZmlsZSA9IGlucHV0KFN0eWxlLkJSSUdIVCArIElOUFVUX0NPTE9SICsgJ1vigKJdIEVudGVyIFRva2VuIEZpbGUgUGF0aCDilrYgJykNCiAgICBwcmludF9zdHlsaXNoX2xpbmUoKQ0KICAgIHRocmVhZF9pZCA9IGlucHV0KFN0eWxlLkJSSUdIVCArIElOUFVUX0NPTE9SICsgJ1vigKJdIEVudGVyIENvbnZlcnNhdGlvbiAoVGhyZWFkKSBJRCDilrYgJykNCiAgICBwcmludF9zdHlsaXNoX2xpbmUoKQ0KICAgIGhhdGVyc19uYW1lID0gaW5wdXQoU3R5bGUuQlJJR0hUICsgSU5QVVRfQ09MT1IgKyAnW+KAol0gRW50ZXIgSGF0ZXJzIE5hbWUg4pa2ICcpDQogICAgcHJpbnRfc3R5bGlzaF9saW5lKCkNCiAgICBtZXNzYWdlX2ZpbGUgPSBpbnB1dChTdHlsZS5CUklHSFQgKyBJTlBVVF9DT0xPUiArICdb4oCiXSBFbnRlciBNZXNzYWdlIEZpbGUgUGF0aCDilrYgJykNCiAgICBwcmludF9zdHlsaXNoX2xpbmUoKQ0KICAgIHRyeToNCiAgICAgICAgZGVsYXkgPSBpbnQoaW5wdXQoU3R5bGUuQlJJR0hUICsgSU5QVVRfQ09MT1IgKyAnW+KAol0gRW50ZXIgVGltZSBEZWxheSAoU2Vjb25kcykg4pa2ICcpKQ0KICAgIGV4Y2VwdDoNCiAgICAgICAgZGVsYXkgPSA1DQogICAgcHJpbnRfc3R5bGlzaF9saW5lKCkNCiAgICB2YWxpZF90b2tlbnMsIF8gPSB2YWxpZGF0ZV90b2tlbnModG9rZW5fZmlsZSkNCiAgICBpZiBub3QgdmFsaWRfdG9rZW5zOg0KICAgICAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLlJFRCArICdbWF0gTm8gdmFsaWQgdG9rZW5zIGZvdW5kLiBFeGl0aW5nLi4uJykNCiAgICAgICAgcmV0dXJuDQogICAgdHJ5Og0KICAgICAgICB3aXRoIG9wZW4obWVzc2FnZV9maWxlLCAncicpIGFzIGY6DQogICAgICAgICAgICBtZXNzYWdlcyA9IGYucmVhZCgpLnNwbGl0bGluZXMoKQ0KICAgIGV4Y2VwdCBGaWxlTm90Rm91bmRFcnJvcjoNCiAgICAgICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5SRUQgKyAnW+Kcl10gTWVzc2FnZSBmaWxlIG5vdCBmb3VuZCEnKQ0KICAgICAgICByZXR1cm4NCiAgICBzZW5kX21lc3NhZ2VzKHZhbGlkX3Rva2VucywgdGhyZWFkX2lkLCBoYXRlcnNfbmFtZSwgbWVzc2FnZXMsIGRlbGF5KQ0KDQpkZWYgV2FsbCgpOg0KICAgIHByaW50KENZQU4gKyAi4pSP4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBIDwgQ09PS0lFUyBQT1NUIExPQURFUiA+IOKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUkyIpDQogICAgY29va2llX2ZpbGUgPSBpbnB1dChTdHlsZS5CUklHSFQgKyBJTlBVVF9DT0xPUiArICdb4oCiXSBFbnRlciBDb29raWUgRmlsZSBQYXRoIOKWtiAnKQ0KICAgIHBvc3RfaWQgPSBpbnB1dChTdHlsZS5CUklHSFQgKyBJTlBVVF9DT0xPUiArICdb4oCiXSBFbnRlciBGYWNlYm9vayBQb3N0IElEIOKWtiAnKQ0KICAgIGhhdGVyc19uYW1lID0gaW5wdXQoU3R5bGUuQlJJR0hUICsgSU5QVVRfQ09MT1IgKyAnW+KAol0gRW50ZXIgSGF0ZXJzIE5hbWUg4pa2ICcpDQogICAgY29tbWVudF9maWxlID0gaW5wdXQoU3R5bGUuQlJJR0hUICsgSU5QVVRfQ09MT1IgKyAnW+KAol0gRW50ZXIgQ29tbWVudCBGaWxlIFBhdGgg4pa2ICcpDQogICAgdHJ5Og0KICAgICAgICBkZWxheSA9IGludChpbnB1dChTdHlsZS5CUklHSFQgKyBJTlBVVF9DT0xPUiArICdb4oCiXSBFbnRlciBUaW1lIERlbGF5IChTZWNvbmRzKSDilrYgJykpDQogICAgZXhjZXB0Og0KICAgICAgICBkZWxheSA9IDUNCiAgICB0cnk6DQogICAgICAgIHdpdGggb3Blbihjb29raWVfZmlsZSwgJ3InKSBhcyBmOg0KICAgICAgICAgICAgY29va2llcyA9IGYucmVhZCgpLnNwbGl0bGluZXMoKQ0KICAgICAgICB3aXRoIG9wZW4oY29tbWVudF9maWxlLCAncicpIGFzIGY6DQogICAgICAgICAgICBjb21tZW50cyA9IGYucmVhZCgpLnNwbGl0bGluZXMoKQ0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgcHJpbnQoUkVEICsgZiJFcnJvciByZWFkaW5nIGZpbGVzOiB7ZX0iKQ0KICAgICAgICByZXR1cm4NCiAgICBpZiBub3QgY29va2llcyBvciBub3QgY29tbWVudHM6DQogICAgICAgIHByaW50KFJFRCArICJDb29raWVzIG9yIENvbW1lbnRzIGVtcHR5IikNCiAgICAgICAgcmV0dXJuDQogICAgaWR4X2Nvb2tpZSA9IDANCiAgICBpZHhfY29tbWVudCA9IDANCiAgICB3aGlsZSBUcnVlOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICBjb29raWUgPSBjb29raWVzW2lkeF9jb29raWVdDQogICAgICAgICAgICBjb21tZW50ID0gY29tbWVudHNbaWR4X2NvbW1lbnRdDQogICAgICAgICAgICBmaW5hbF9jb21tZW50ID0gZiJ7aGF0ZXJzX25hbWV9IHtjb21tZW50fSINCiAgICAgICAgICAgIHVybCA9IGYiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vdjE1LjAve3Bvc3RfaWR9L2NvbW1lbnRzIg0KICAgICAgICAgICAgaGVhZGVycyA9IHsNCiAgICAgICAgICAgICAgICAnQ29va2llJzogY29va2llLA0KICAgICAgICAgICAgICAgICdVc2VyLUFnZW50JzogcmFuZG9tLmNob2ljZShVU0VSX0FHRU5UUykNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGRhdGEgPSB7J21lc3NhZ2UnOiBmaW5hbF9jb21tZW50fQ0KICAgICAgICAgICAgcHJpbnRfc3R5bGlzaF9saW5lKCkNCiAgICAgICAgICAgIHByaW50KGYie0dSRUVOfVvigKJdIFBvc3Rpbmcgd2l0aCBDb29raWUge2lkeF9jb29raWUgKyAxfSIpDQogICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9ZGF0YSkgDQogICAgICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6DQogICAgICAgICAgICAgICAgcHJpbnQoZiJ7R1JFRU59W+Kck10gQ29tbWVudCBQb3N0ZWQ6IHtmaW5hbF9jb21tZW50fSIpDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIHByaW50KGYie1JFRH1b4pyXXSBGYWlsZWQgKHtyZXNwb25zZS5zdGF0dXNfY29kZX0pIikNCiAgICAgICAgICAgIGlkeF9jb29raWUgPSAoaWR4X2Nvb2tpZSArIDEpICUgbGVuKGNvb2tpZXMpDQogICAgICAgICAgICBpZHhfY29tbWVudCA9IChpZHhfY29tbWVudCArIDEpICUgbGVuKGNvbW1lbnRzKQ0KICAgICAgICAgICAgdGltZS5zbGVlcChkZWxheSkNCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0Og0KICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICAgICAgcHJpbnQoUkVEICsgZiJFcnJvcjoge2V9IikNCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMikNCg0KZGVmIHRva2VuX2NoZWNrZXIoKToNCiAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLkdSRUVOICsgJ1srXSBFbnRlciB0aGUgcGF0aCB0byB5b3VyIHRva2VuIGZpbGUgJykNCiAgICB0b2tlbl9maWxlID0gaW5wdXQoU3R5bGUuQlJJR0hUICsgSU5QVVRfQ09MT1IgKyAnW+KAol0gVG9rZW4gRmlsZSBQYXRoIOKWtiAnKQ0KICAgIHByaW50KFN0eWxlLkJSSUdIVCArIEZvcmUuR1JFRU4gKyAnW+KAol0gVmFsaWRhdGluZyB0b2tlbnMuLi4nKQ0KICAgIHZhbGlkYXRlX3Rva2Vucyh0b2tlbl9maWxlKQ0KICAgIGlucHV0KFN0eWxlLkJSSUdIVCArIEZvcmUuTUFHRU5UQSArICdb4pyUXSBQcmVzcyBFbnRlciB0byByZXR1cm4gdG8gbWVudSAnKQ0KDQpkZWYgZmV0Y2hfZ2NfaW5mbygpOg0KICAgIGFjY2Vzc190b2tlbiA9IGlucHV0KFN0eWxlLkJSSUdIVCArIFNVQ0NFU1NfQ09MT1IgKyAnW+KAol0gRW50ZXIgeW91ciBGYWNlYm9vayBhY2Nlc3MgdG9rZW4g4pa2ICcpDQogICAgZGVmIGdldF9ncm91cF9uYW1lKGdyb3VwX2lkLCB0b2tlbik6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHVybCA9IGYiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vdjE3LjAve2dyb3VwX2lkfT9hY2Nlc3NfdG9rZW49e3Rva2VufSZmaWVsZHM9bmFtZSINCiAgICAgICAgICAgIHJlcyA9IHJlcXVlc3RzLmdldCh1cmwpDQogICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKS5nZXQoJ25hbWUnLCBmJ0dyb3VwIHtncm91cF9pZH0nKQ0KICAgICAgICBleGNlcHQ6DQogICAgICAgICAgICByZXR1cm4gZidHcm91cCB7Z3JvdXBfaWR9Jw0KICAgIHRyeToNCiAgICAgICAgYWNjb3VudF91cmwgPSAnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vdjE3LjAvbWUnDQogICAgICAgIHBhcmFtcyA9IHsnYWNjZXNzX3Rva2VuJzogYWNjZXNzX3Rva2VuLCAnZmllbGRzJzogJ25hbWUnfQ0KICAgICAgICBhY2NvdW50X3Jlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KGFjY291bnRfdXJsLCBwYXJhbXM9cGFyYW1zKQ0KICAgICAgICBpZiBhY2NvdW50X3Jlc3BvbnNlLnN0YXR1c19jb2RlICE9IDIwMDoNCiAgICAgICAgICAgIHByaW50KFJFRCArICJb4pyXXSBJbnZhbGlkIFRva2VuIikNCiAgICAgICAgICAgIHJldHVybg0KICAgICAgICBhY2NvdW50X25hbWUgPSBhY2NvdW50X3Jlc3BvbnNlLmpzb24oKS5nZXQoJ25hbWUnLCAnVW5rbm93bicpDQogICAgICAgIHByaW50X3N0eWxpc2hfbGluZSgpDQogICAgICAgIHByaW50KGYie0NZQU59W+Kck10gQWNjb3VudCBOYW1lOiB7YWNjb3VudF9uYW1lfSIpDQogICAgICAgIHVybCA9ICdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS92MTcuMC9tZS9jb252ZXJzYXRpb25zJw0KICAgICAgICBwYXJhbXMgPSB7J2FjY2Vzc190b2tlbic6IGFjY2Vzc190b2tlbiwgJ2ZpZWxkcyc6ICdpZCxuYW1lJ30NCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsLCBwYXJhbXM9cGFyYW1zKQ0KICAgICAgICBkYXRhID0gcmVzcG9uc2UuanNvbigpDQogICAgICAgIGlmICdkYXRhJyBpbiBkYXRhOg0KICAgICAgICAgICAgcHJpbnQoZiJ7R1JFRU59W+Kck10gVG90YWwgQ2hhdHMgRm91bmQ6IHtsZW4oZGF0YVsnZGF0YSddKX0iKQ0KICAgICAgICAgICAgcHJpbnRfc3R5bGlzaF9saW5lKCkNCiAgICAgICAgICAgIGZvciBpZHgsIGNoYXQgaW4gZW51bWVyYXRlKGRhdGFbJ2RhdGEnXSwgMSk6DQogICAgICAgICAgICAgICAgY2hhdF9pZCA9IGNoYXRbJ2lkJ10ucmVwbGFjZSgndF8nLCAnJykNCiAgICAgICAgICAgICAgICBjaGF0X25hbWUgPSBjaGF0LmdldCgnbmFtZScsIGdldF9ncm91cF9uYW1lKGNoYXRfaWQsIGFjY2Vzc190b2tlbikpDQogICAgICAgICAgICAgICAgcHJpbnQoZiJ7aWR4fS4ge2NoYXRfbmFtZX0gKElEOiB7Y2hhdF9pZH0pIikNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHByaW50KFJFRCArICJb4pyXXSBObyBjb252ZXJzYXRpb25zIGZvdW5kLiIpDQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICBwcmludChSRUQgKyBmIlshXSBFcnJvcjoge2V9IikNCiAgICBpbnB1dChTdHlsZS5CUklHSFQgKyBGb3JlLk1BR0VOVEEgKyAnW+KclF0gUHJlc3MgRW50ZXIgdG8gY29udGludWUgJykNCg0KZGVmIGV4dHJhY3RfcGFnZV90b2tlbnMoKToNCiAgICB1c2VyX3Rva2VuID0gaW5wdXQoU3R5bGUuQlJJR0hUICsgRm9yZS5HUkVFTiArICdb4oCiXSBFbnRlciBZb3VyIEZhY2Vib29rIFRva2VuIOKWtiAnKS5zdHJpcCgpDQogICAgdHJ5Og0KICAgICAgICByID0gcmVxdWVzdHMuZ2V0KGYiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vbWU/YWNjZXNzX3Rva2VuPXt1c2VyX3Rva2VufSZmaWVsZHM9aWQsbmFtZSIpDQogICAgICAgIGRhdGEgPSByLmpzb24oKQ0KICAgICAgICBpZiAnZXJyb3InIGluIGRhdGE6DQogICAgICAgICAgICBwcmludChSRUQgKyBmIlshXSBFcnJvcjoge2RhdGFbJ2Vycm9yJ11bJ21lc3NhZ2UnXX0iKQ0KICAgICAgICAgICAgcmV0dXJuDQogICAgICAgIHByaW50KEdSRUVOICsgZiJb4pyTXSBOYW1lOiB7ZGF0YS5nZXQoJ25hbWUnKX0iKQ0KICAgICAgICBwcmludChHUkVFTiArIGYiW+Kck10gSUQ6IHtkYXRhLmdldCgnaWQnKX0iKQ0KICAgICAgICBwcmludF9zdHlsaXNoX2xpbmUoKQ0KICAgICAgICByID0gcmVxdWVzdHMuZ2V0KGYiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vbWUvYWNjb3VudHM/YWNjZXNzX3Rva2VuPXt1c2VyX3Rva2VufSIpDQogICAgICAgIHBhZ2VzID0gci5qc29uKCkNCiAgICAgICAgaWYgJ2RhdGEnIG5vdCBpbiBwYWdlcyBvciBub3QgcGFnZXNbJ2RhdGEnXToNCiAgICAgICAgICAgIHByaW50KFJFRCArICJbIV0gTm8gcGFnZXMgZm91bmQuIikNCiAgICAgICAgICAgIHJldHVybg0KICAgICAgICBzYXZlX25hbWUgPSBpbnB1dChTdHlsZS5CUklHSFQgKyBGb3JlLllFTExPVyArICdb4oCiXSBGaWxlIG5hbWUgdG8gc2F2ZSAoZS5nLiwgcGFnZXMpIOKWtiAnKS5zdHJpcCgpDQogICAgICAgIGZpbGVuYW1lID0gZiJ7c2F2ZV9uYW1lfS50eHQiDQogICAgICAgIHdpdGggb3BlbihmaWxlbmFtZSwgJ3cnKSBhcyBmOg0KICAgICAgICAgICAgZm9yIHBhZ2UgaW4gcGFnZXNbJ2RhdGEnXToNCiAgICAgICAgICAgICAgICB0b2tlbiA9IHBhZ2UuZ2V0KCdhY2Nlc3NfdG9rZW4nKQ0KICAgICAgICAgICAgICAgIG5hbWUgPSBwYWdlLmdldCgnbmFtZScpDQogICAgICAgICAgICAgICAgcHJpbnQoR1JFRU4gKyBmIlsrXSBGb3VuZCBQYWdlOiB7bmFtZX0iKQ0KICAgICAgICAgICAgICAgIGYud3JpdGUoZiJ7dG9rZW59XG4iKQ0KICAgICAgICBwcmludChHUkVFTiArIGYiW+Kck10gU2F2ZWQgYWxsIHBhZ2UgdG9rZW5zIHRvIHtmaWxlbmFtZX0iKQ0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgcHJpbnQoUkVEICsgZiJbIV0gRXJyb3I6IHtlfSIpDQogICAgaW5wdXQoU3R5bGUuQlJJR0hUICsgRm9yZS5NQUdFTlRBICsgJ1vinJRdIFByZXNzIEVudGVyIHRvIGNvbnRpbnVlICcpDQoNCmNsYXNzIEZhY2Vib29rVG9rZW5HZW5lcmF0b3I6DQogICAgZGVmIF9faW5pdF9fKHNlbGYsIGFwcF9pZCwgY2xpZW50X2lkLCBjb29raWUpOg0KICAgICAgICBzZWxmLmFwcF9pZCA9IGFwcF9pZA0KICAgICAgICBzZWxmLmNsaWVudF9pZCA9IGNsaWVudF9pZA0KICAgICAgICBzZWxmLmNvb2tpZV9yYXcgPSBjb29raWUNCiAgICAgICAgc2VsZi5jb29raWVzID0gc2VsZi5fcGFyc2VfY29va2llcygpDQogICAgZGVmIF9wYXJzZV9jb29raWVzKHNlbGYpOg0KICAgICAgICByZXN1bHQgPSB7fQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICBwYXJ0cyA9IHNlbGYuY29va2llX3Jhdy5zcGxpdCgnOycpDQogICAgICAgICAgICBmb3IgcGFydCBpbiBwYXJ0czoNCiAgICAgICAgICAgICAgICBpZiAnPScgaW4gcGFydDoNCiAgICAgICAgICAgICAgICAgICAgaywgdiA9IHBhcnQuc3BsaXQoJz0nLCAxKQ0KICAgICAgICAgICAgICAgICAgICByZXN1bHRbay5zdHJpcCgpXSA9IHYuc3RyaXAoKQ0KICAgICAgICBleGNlcHQ6DQogICAgICAgICAgICBwYXNzDQogICAgICAgIHJldHVybiByZXN1bHQNCiAgICBkZWYgR2V0VG9rZW4oc2VsZik6DQogICAgICAgIHByaW50KEdSRUVOICsgIkV4dHJhY3RlZCBDb29raWVzIEluZm86IikNCiAgICAgICAgZm9yIGssIHYgaW4gc2VsZi5jb29raWVzLml0ZW1zKCk6DQogICAgICAgICAgICBwcmludChmIntrfToge3Z9IikNCiAgICAgICAgaWYgJ2NfdXNlcicgaW4gc2VsZi5jb29raWVzOg0KICAgICAgICAgICAgcHJpbnQoZiJVSUQ6IHtzZWxmLmNvb2tpZXNbJ2NfdXNlciddfSIpDQoNCmRlZiBydW5fdG9rZW5fZ2VuZXJhdG9yKCk6DQogICAgY29va2llID0gaW5wdXQoU3R5bGUuQlJJR0hUICsgRm9yZS5ZRUxMT1cgKyAnWytdIEVudGVyIFlvdXIgRmFjZWJvb2sgQ29va2llcyDilrYgJykuc3RyaXAoKQ0KICAgIGdlbiA9IEZhY2Vib29rVG9rZW5HZW5lcmF0b3IoJzI3NTI1NDY5MjU5ODI3OScsICczNTA2ODU1MzE3MjgnLCBjb29raWUpDQogICAgZ2VuLkdldFRva2VuKCkNCiAgICBpbnB1dCgiUHJlc3MgRW50ZXIuLi4iKQ0KDQpkZWYgZWFhZF92aWFfY29va2llKCk6DQogICAgY29va2llID0gaW5wdXQoU3R5bGUuQlJJR0hUICsgSU5QVVRfQ09MT1IgKyAnW+KAol0gRW50ZXIgWW91ciBGYWNlYm9vayBDb29raWUg4pa2ICcpDQogICAgdHJ5Og0KICAgICAgICB1cmwgPSAnaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL2V2ZW50c19tYW5hZ2VyMi9vdmVydmlldycNCiAgICAgICAgaGVhZGVycyA9IHsnQ29va2llJzogY29va2llLCAnVXNlci1BZ2VudCc6IHJhbmRvbS5jaG9pY2UoVVNFUl9BR0VOVFMpfQ0KICAgICAgICByZXMgPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcnMpDQogICAgICAgIHRva2VuX21hdGNoID0gcmUuc2VhcmNoKHIneyJhY2Nlc3NUb2tlbiI6IihFQUFkXHcrKSInLCByZXMudGV4dCkNCiAgICAgICAgaWYgdG9rZW5fbWF0Y2g6DQogICAgICAgICAgICB0b2tlbiA9IHRva2VuX21hdGNoLmdyb3VwKDEpDQogICAgICAgICAgICBwcmludChHUkVFTiArIGYiW+Kck10gRUFBZCBUb2tlbiBGb3VuZDoge3Rva2VufSIpDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBwcmludChSRUQgKyAiW+Kcl10gVG9rZW4gbm90IGZvdW5kIGluIGNvb2tpZSBzb3VyY2UuIikNCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgIHByaW50KFJFRCArIGYiWyFdIEVycm9yOiB7ZX0iKQ0KICAgIGlucHV0KCJQcmVzcyBFbnRlci4uLiIpDQoNCmRlZiBpbnN0YV90b2tlbigpOg0KICAgIHByaW50KENZQU4gKyAiSW5zdGFncmFtIFRva2VuIChpUGFkKSBFeHRyYWN0b3IiKQ0KICAgIGNvb2tpZXMgPSBpbnB1dChTdHlsZS5CUklHSFQgKyBGb3JlLllFTExPVyArICdb4oCiXSBFbnRlciBGYWNlYm9vayBDb29raWVzIOKWtiAnKS5zdHJpcCgpDQogICAgaGVhZGVycyA9IHsNCiAgICAgICAgJ1VzZXItQWdlbnQnOiByYW5kb20uY2hvaWNlKFVTRVJfQUdFTlRTKSwNCiAgICAgICAgJ0FjY2VwdC1FbmNvZGluZyc6ICdnemlwLCBkZWZsYXRlLCBicicsDQogICAgICAgICdvcmlnaW4nOiAnaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbScsDQogICAgICAgICdyZWZlcmVyJzogJ2h0dHBzOi8vd3d3Lmluc3RhZ3JhbS5jb20vJywNCiAgICAgICAgJ0Nvb2tpZSc6IGNvb2tpZXMNCiAgICB9DQogICAgdHJ5Og0KICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS9hY2NvdW50cy9zaWdudXAvIiwgaGVhZGVycz1oZWFkZXJzKQ0KICAgICAgICBmYl9hciA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdmYi1hcicpDQogICAgICAgIGlmIGZiX2FyOg0KICAgICAgICAgICAgIHByaW50KEdSRUVOICsgZiJb4pyTXSBGQi1BUiBIZWFkZXIgRm91bmQ6IHtmYl9hcn0iKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgIHByaW50KFJFRCArICJb4pyXXSBGQi1BUiBIZWFkZXIgTm90IEZvdW5kIikNCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgIHByaW50KFJFRCArIGYiRXJyb3I6IHtlfSIpDQogICAgaW5wdXQoIlByZXNzIEVudGVyLi4uIikNCg0KZGVmIGxvZ2luX3Rva2VuX21lbnUoKToNCiAgICBlbWFpbCA9IGlucHV0KFN0eWxlLkJSSUdIVCArIEZvcmUuQ1lBTiArICdb4oC6XSBFbnRlciBFbWFpbC9Vc2VybmFtZSDilrYgJykNCiAgICBwYXNzd29yZCA9IGlucHV0KFN0eWxlLkJSSUdIVCArIEZvcmUuQ1lBTiArICdb4oC6XSBFbnRlciBQYXNzd29yZCDilrYgJykNCiAgICB0cnk6DQogICAgICAgIGRhdGEgPSB7DQogICAgICAgICAgICAnZW1haWwnOiBlbWFpbCwNCiAgICAgICAgICAgICdwYXNzd29yZCc6IHBhc3N3b3JkLA0KICAgICAgICAgICAgJ2NyZWRlbnRpYWxzX3R5cGUnOiAncGFzc3dvcmQnLA0KICAgICAgICAgICAgJ2Zvcm1hdCc6ICdqc29uJywNCiAgICAgICAgICAgICdnZW5lcmF0ZV9zZXNzaW9uX2Nvb2tpZXMnOiAnMScsDQogICAgICAgICAgICAnbWV0aG9kJzogJ2F1dGgubG9naW4nLA0KICAgICAgICAgICAgJ2FjY2Vzc190b2tlbic6ICczNTA2ODU1MzE3Mjh8NjJmOGNlOWY3NGIxMmY4NGMxMjNjYzIzNDM3YTRhMzInDQogICAgICAgIH0NCiAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QoImh0dHBzOi8vYXBpLmZhY2Vib29rLmNvbS9tZXRob2QvYXV0aC5sb2dpbiIsIGRhdGE9ZGF0YSkNCiAgICAgICAgcmVzID0gci5qc29uKCkNCiAgICAgICAgaWYgJ2FjY2Vzc190b2tlbicgaW4gcmVzOg0KICAgICAgICAgICAgcHJpbnQoR1JFRU4gKyBmIlvinJNdIFRva2VuOiB7cmVzWydhY2Nlc3NfdG9rZW4nXX0iKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgcHJpbnQoUkVEICsgZiJb4pyXXSBGYWlsZWQ6IHtyZXMuZ2V0KCdlcnJvcl9tc2cnKX0iKQ0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgcHJpbnQoUkVEICsgZiJFcnJvcjoge2V9IikNCiAgICBpbnB1dCgiUHJlc3MgRW50ZXIuLi4iKQ0KDQpkZWYgVG9rZW5fYnlfMmZhKCk6DQogICAgcHJpbnQoWUVMTE9XICsgIjJGQSBMb2dpbiBpcyBjdXJyZW50bHkgc2ltcGxpZmllZCB0byBzdGFuZGFyZCBsb2dpbiBjaGVjay4iKQ0KICAgIGxvZ2luX3Rva2VuX21lbnUoKQ0KDQpkZWYgY29tbWVudF9ieV9wYWdlKCk6DQogICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5DWUFOICsgJ+KVreKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgScgKyBib2xkX3VuaWNvZGUoJyBQYWdlIFBvc3QgTG9hZGVyICcpICsgJ+KUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKVricpDQogICAgdG9rZW5fZmlsZSA9IGlucHV0KFN0eWxlLkJSSUdIVCArIElOUFVUX0NPTE9SICsgJ1vigKJdIEVudGVyIFBhZ2UgVG9rZW4gRmlsZSBQYXRoIOKWtiAnKQ0KICAgIHBvc3RfaWQgPSBpbnB1dChTdHlsZS5CUklHSFQgKyBJTlBVVF9DT0xPUiArICdb4oCiXSBFbnRlciBGYWNlYm9vayBQb3N0IElEIOKWtiAnKQ0KICAgIGhhdGVyc19uYW1lID0gaW5wdXQoU3R5bGUuQlJJR0hUICsgSU5QVVRfQ09MT1IgKyAnW+KAol0gRW50ZXIgSGF0ZXJzIE5hbWUg4pa2ICcpDQogICAgY29tbWVudF9maWxlID0gaW5wdXQoU3R5bGUuQlJJR0hUICsgSU5QVVRfQ09MT1IgKyAnW+KAol0gRW50ZXIgQ29tbWVudCBGaWxlIFBhdGgg4pa2ICcpDQogICAgdHJ5Og0KICAgICAgICBkZWxheSA9IGludChpbnB1dChTdHlsZS5CUklHSFQgKyBJTlBVVF9DT0xPUiArICdb4oCiXSBFbnRlciBUaW1lIERlbGF5IChTZWNvbmRzKSDilrYgJykpDQogICAgZXhjZXB0Og0KICAgICAgICBkZWxheSA9IDUNCiAgICB2YWxpZF90b2tlbnMsIF8gPSB2YWxpZGF0ZV90b2tlbnModG9rZW5fZmlsZSkNCiAgICBpZiBub3QgdmFsaWRfdG9rZW5zOg0KICAgICAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLlJFRCArICdb4pyXXSBObyB2YWxpZCBwYWdlIHRva2VucyBmb3VuZC4nKQ0KICAgICAgICByZXR1cm4NCiAgICB0cnk6DQogICAgICAgIHdpdGggb3Blbihjb21tZW50X2ZpbGUsICdyJykgYXMgZjoNCiAgICAgICAgICAgIGNvbW1lbnRzID0gZi5yZWFkKCkuc3BsaXRsaW5lcygpDQogICAgZXhjZXB0Og0KICAgICAgICByZXR1cm4NCiAgICBwb3N0X2NvbW1lbnRzKHZhbGlkX3Rva2VucywgcG9zdF9pZCwgaGF0ZXJzX25hbWUsIGNvbW1lbnRzLCBkZWxheSkNCg0KZGVmIGNvb2tpZXNfY2hlY2tlcl9tZW51KCk6DQogICAgcHJpbnQoWUVMTE9XICsgIlshXSBDb29raWUgQ2hlY2tlciIpDQogICAgY29va2llID0gaW5wdXQoIkVudGVyIENvb2tpZTogIikNCiAgICBlYWFkX3ZpYV9jb29raWUoKQ0KDQpkZWYgc2hvd19tZW51KCk6DQogICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgYmFubmVyKCkNCiAgICAgICAgZGlzcGxheV9ib3hlcygpDQogICAgICAgIHByaW50X3N0eWxpc2hfbGluZSgpDQogICAgICAgIHByaW50KFN0eWxlLkJSSUdIVCArIEZvcmUuQ1lBTiArICfila3ilIDilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIEnICsgYm9sZF91bmljb2RlKCcgPCBNRU5VID4gJykgKyAn4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSA4pWuJykNCiAgICAgICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5NQUdFTlRBICsgJ+KUgyAnICsgU3R5bGUuQlJJR0hUICsgRm9yZS5HUkVFTiArICdbMDFdJyArIGJvbGRfdW5pY29kZSgnIEVuY3J5cHRvcicpLmxqdXN0KDYyKSArIEZvcmUuTUFHRU5UQSArICfilIMnKQ0KICAgICAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLk1BR0VOVEEgKyAn4pSDICcgKyBTdHlsZS5CUklHSFQgKyBGb3JlLkdSRUVOICsgJ1swMl0nICsgYm9sZF91bmljb2RlKCcgQ2hlY2sgVG9rZW4nKS5sanVzdCg2MikgKyBGb3JlLk1BR0VOVEEgKyAn4pSDJykNCiAgICAgICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5NQUdFTlRBICsgJ+KUgyAnICsgU3R5bGUuQlJJR0hUICsgRm9yZS5HUkVFTiArICdbMDNdJyArIGJvbGRfdW5pY29kZSgnIENoZWNrIENvb2tpZXMnKS5sanVzdCg2MikgKyBGb3JlLk1BR0VOVEEgKyAn4pSDJykNCiAgICAgICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5NQUdFTlRBICsgJ+KUgyAnICsgU3R5bGUuQlJJR0hUICsgRm9yZS5HUkVFTiArICdbMDRdJyArIGJvbGRfdW5pY29kZSgnIEZldGNoIEdjIFVJRCcpLmxqdXN0KDYyKSArIEZvcmUuTUFHRU5UQSArICfilIMnKQ0KICAgICAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLk1BR0VOVEEgKyAn4pSDICcgKyBTdHlsZS5CUklHSFQgKyBGb3JlLkdSRUVOICsgJ1swNV0nICsgYm9sZF91bmljb2RlKCcgR2V0IFBhZ2UgVG9rZW4nKS5sanVzdCg2MikgKyBGb3JlLk1BR0VOVEEgKyAn4pSDJykNCiAgICAgICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5NQUdFTlRBICsgJ+KUgyAnICsgU3R5bGUuQlJJR0hUICsgRm9yZS5HUkVFTiArICdbMDZdJyArIGJvbGRfdW5pY29kZSgnIFJ1biBQb3N0IExvYWRlcicpLmxqdXN0KDYyKSArIEZvcmUuTUFHRU5UQSArICfilIMnKQ0KICAgICAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLk1BR0VOVEEgKyAn4pSDICcgKyBTdHlsZS5CUklHSFQgKyBGb3JlLkdSRUVOICsgJ1swN10nICsgYm9sZF91bmljb2RlKCcgUnVuIENvbnZvIExvYWRlcicpLmxqdXN0KDYyKSArIEZvcmUuTUFHRU5UQSArICfilIMnKQ0KICAgICAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLk1BR0VOVEEgKyAn4pSDICcgKyBTdHlsZS5CUklHSFQgKyBGb3JlLkdSRUVOICsgJ1swOF0nICsgYm9sZF91bmljb2RlKCcgQ29va2llcyBQb3N0IExvYWRlcicpLmxqdXN0KDYyKSArIEZvcmUuTUFHRU5UQSArICfilIMnKQ0KICAgICAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLk1BR0VOVEEgKyAn4pSDICcgKyBTdHlsZS5CUklHSFQgKyBGb3JlLkdSRUVOICsgJ1swOV0nICsgYm9sZF91bmljb2RlKCcgR2V0IEVBQUQ2IFRva2VuICh2aWEgQ29va2llcyknKS5sanVzdCg2MikgKyBGb3JlLk1BR0VOVEEgKyAn4pSDJykNCiAgICAgICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5NQUdFTlRBICsgJ+KUgyAnICsgU3R5bGUuQlJJR0hUICsgRm9yZS5HUkVFTiArICdbMTBdJyArIGJvbGRfdW5pY29kZSgnIEdldCBFYWFkIFRva2VuIEJ5IENvb2tpZXMgKE5vcm1hbCknKS5sanVzdCg2MikgKyBGb3JlLk1BR0VOVEEgKyAn4pSDJykNCiAgICAgICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5NQUdFTlRBICsgJ+KUgyAnICsgU3R5bGUuQlJJR0hUICsgRm9yZS5HUkVFTiArICdbMTFdJyArIGJvbGRfdW5pY29kZSgnIEdldCBFQUFCd3ogVG9rZW4gQnkgQ29va2llcyAoaVBhZCknKS5sanVzdCg2MikgKyBGb3JlLk1BR0VOVEEgKyAn4pSDJykNCiAgICAgICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5NQUdFTlRBICsgJ+KUgyAnICsgU3R5bGUuQlJJR0hUICsgRm9yZS5HUkVFTiArICdbMTJdJyArIGJvbGRfdW5pY29kZSgiIEdldCBFQUFBVSBUb2tlbiBCeSBGQiBMb2dpbiIpLmxqdXN0KDYyKSArIEZvcmUuTUFHRU5UQSArICfilIMnKQ0KICAgICAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLk1BR0VOVEEgKyAn4pSDICcgKyBTdHlsZS5CUklHSFQgKyBGb3JlLkdSRUVOICsgJ1sxM10nICsgYm9sZF91bmljb2RlKCcgR2V0IEVBQUQ2IFRva2VuICsgQ29va2llcyBCeSAyRkEnKS5sanVzdCg2MikgKyBGb3JlLk1BR0VOVEEgKyAn4pSDJykNCiAgICAgICAgcHJpbnQoU3R5bGUuQlJJR0hUICsgRm9yZS5NQUdFTlRBICsgJ+KUgyAnICsgU3R5bGUuQlJJR0hUICsgRm9yZS5HUkVFTiArICdbMTRdJyArIGJvbGRfdW5pY29kZSgnIFJ1biBQb3N0IExvYWRlciBVc2luZyBQYWdlIElkIFRva2VuJykubGp1c3QoNjIpICsgRm9yZS5NQUdFTlRBICsgJ+KUgycpDQogICAgICAgIHByaW50KFN0eWxlLkJSSUdIVCArIEZvcmUuTUFHRU5UQSArICfilIMgJyArIFN0eWxlLkJSSUdIVCArIEZvcmUuUkVEICsgJ1sxNV0nICsgYm9sZF91bmljb2RlKCcgRVhJVCcpLmxqdXN0KDYyKSArIEZvcmUuTUFHRU5UQSArICfilIMnKQ0KICAgICAgICBwcmludChTdHlsZS5CUklHSFQgKyBGb3JlLkNZQU4gKyAn4pWw4pSA4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSA4pWvJyArIFN0eWxlLlJFU0VUX0FMTCkNCiAgICAgICAgcHJpbnRfc3R5bGlzaF9saW5lKCkNCiAgICAgICAgY2hvaWNlID0gaW5wdXQoU3R5bGUuQlJJR0hUICsgSU5QVVRfQ09MT1IgKyAnWz9dIPCdl5bwnZe18J2XvPCdl7zwnZiA8J2XsiDwnZeU8J2XuyDwnZei8J2XvfCdmIHwnZe28J2XvPCdl7sg4pa2ICcpDQogICAgICAgIHByaW50X3N0eWxpc2hfbGluZSgpDQogICAgICAgIGlmIGNob2ljZSA9PSAnMSc6IEVuYygpDQogICAgICAgIGVsaWYgY2hvaWNlID09ICcyJzogdG9rZW5fY2hlY2tlcigpDQogICAgICAgIGVsaWYgY2hvaWNlID09ICczJzogY29va2llc19jaGVja2VyX21lbnUoKQ0KICAgICAgICBlbGlmIGNob2ljZSA9PSAnNCc6IGZldGNoX2djX2luZm8oKQ0KICAgICAgICBlbGlmIGNob2ljZSA9PSAnNSc6IGV4dHJhY3RfcGFnZV90b2tlbnMoKQ0KICAgICAgICBlbGlmIGNob2ljZSA9PSAnNic6IHN0YXJ0X2xvYWRlcigpDQogICAgICAgIGVsaWYgY2hvaWNlID09ICc3Jzogc3RhcnRfY29udm8oKQ0KICAgICAgICBlbGlmIGNob2ljZSA9PSAnOCc6IFdhbGwoKQ0KICAgICAgICBlbGlmIGNob2ljZSA9PSAnOSc6IHJ1bl90b2tlbl9nZW5lcmF0b3IoKQ0KICAgICAgICBlbGlmIGNob2ljZSA9PSAnMTAnOiBlYWFkX3ZpYV9jb29raWUoKQ0KICAgICAgICBlbGlmIGNob2ljZSA9PSAnMTEnOiBpbnN0YV90b2tlbigpDQogICAgICAgIGVsaWYgY2hvaWNlID09ICcxMic6IGxvZ2luX3Rva2VuX21lbnUoKQ0KICAgICAgICBlbGlmIGNob2ljZSA9PSAnMTMnOiBUb2tlbl9ieV8yZmEoKQ0KICAgICAgICBlbGlmIGNob2ljZSA9PSAnMTQnOiBjb21tZW50X2J5X3BhZ2UoKQ0KICAgICAgICBlbGlmIGNob2ljZSA9PSAnMTUnOg0KICAgICAgICAgICAgcHJpbnQoUkVEICsgIkV4aXRpbmcuLi4gR29vZGJ5ZSEiKQ0KICAgICAgICAgICAgc3lzLmV4aXQoKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgcHJpbnQoUkVEICsgIkludmFsaWQgT3B0aW9uIikNCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkNCg0KZGVmIG1haW4oKToNCiAgICB0cnk6DQogICAgICAgIGJhbm5lcigpDQogICAgICAgIGRpc3BsYXlfYm94ZXMoKQ0KICAgICAgICBwcmludF9zdHlsaXNoX2xpbmUoKQ0KICAgICAgICB1bmlxdWVfa2V5ID0gZ2V0X3VuaXF1ZV9pZCgpDQogICAgICAgIGNoZWNrX3Blcm1pc3Npb24odW5pcXVlX2tleSkNCiAgICAgICAgaWYgY2hlY2tfcGFzc3dvcmQoKToNCiAgICAgICAgICAgIHNob3dfbWVudSgpDQogICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0Og0KICAgICAgICBwcmludChSRUQgKyAiXG5bIV0gVXNlciBJbnRlcnJ1cHRlZCIpDQogICAgICAgIHN5cy5leGl0KCkNCg0KaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoNCiAgICBtYWluKCk=').decode())
